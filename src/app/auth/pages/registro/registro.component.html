<div
  class="min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-800"
>
  <div
    class="mx-auto max-w-4xl w-full sm:w-11/12 md:w-3/4 lg:w-2/3 p-10 sm:p-8 my-2 bg-white dark:bg-slate-700 rounded-lg shadow-xl border border-gray-300 dark:border-gray-600"
  >
    <h2
      class="text-2xl font-bold mb-6 text-center text-gray-900 dark:text-stone-50"
    >
      Registro de Usuario
    </h2>
    <p class="mb-6 text-center text-gray-900 dark:text-stone-50">
      Por favor, completa todos los campos para crear tu cuenta.
    </p>

    <form [formGroup]="registroForm" class="space-y-4">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            for="nombres"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Nombres</label
          >
          <input
            type="text"
            id="nombres"
            formControlName="nombres"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="Ej Luis Fernando"
            maxlength="50"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('nombres')?.invalid &&
              registroForm.get('nombres')?.touched
            "
            >*requerido</small
          >
        </div>
        <div>
          <label
            for="nombres"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Apellidos</label
          >
          <input
            type="text"
            id="apellidos"
            formControlName="apellidos"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="Ej Acosta Freire"
            maxlength="50"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('apellidos')?.invalid &&
              registroForm.get('apellidos')?.touched
            "
            >*requerido</small
          >
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            for="celular"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Celular</label
          >
          <input
            type="text"
            id="celular"
            formControlName="celular"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="098XXXXXXX"
            maxlength="10"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('celular')?.invalid &&
              registroForm.get('celular')?.touched
            "
            >*requerido</small
          >
        </div>

        <div>
          <label
            for="fechaNacimiento"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Fecha de Nacimiento</label
          >
          <input
            type="date"
            id="fechaNacimiento"
            formControlName="fechaNacimiento"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('fechaNacimiento')?.invalid &&
              registroForm.get('fechaNacimiento')?.touched
            "
            >*requerido</small
          >
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('fechaNacimiento')?.hasError('mayorDeEdad') &&
              registroForm.get('fechaNacimiento')?.touched
            "
            >*Debes ser mayor de 18 años</small
          >
        </div>

        <div>
          <label
            for="tipoIdentificacion"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
          >
            Tipo de Identificación
          </label>
          <select
            id="tipoIdentificacion"
            formControlName="tipoIdentificacion"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
          >
            <option disabled value="">Selecciona un tipo</option>
            @for (tipo of tiposIdentificacion; track tipo.value) {
            <option [value]="tipo.value">{{ tipo.label }}</option>
            }
          </select>
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('tipoIdentificacion')?.invalid &&
              registroForm.get('tipoIdentificacion')?.touched
            "
          >
            *requerido
          </small>
        </div>

        <!-- Campo: Número de Identificación -->
        <div>
          <label
      for="identificacion"
      class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
    >
      {{ nombreCampoIdentificacion }}
    </label>
    <input
      type="text"
      id="identificacion"
      formControlName="identificacion"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
      [placeholder]="nombreCampoIdentificacion"
    />
    <small
      class="text-red-500"
      *ngIf="
        registroForm.get('identificacion')?.hasError('required') &&
        registroForm.get('identificacion')?.touched
      "
    >
      *requerido
    </small>
    <small
      *ngIf="
        registroForm.get('identificacion')?.hasError('identificacionInvalida') &&
        registroForm.get('identificacion')?.touched
      "
      class="text-red-500"
    >
      *el número de identificación no es válido
    </small>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            for="email"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Correo Electrónico</label
          >
          <input
            type="text"
            id="email"
            formControlName="email"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="tucorreo@mail.com"
            maxlength="80"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('email')?.invalid &&
              registroForm.get('email')?.touched
            "
            >*requerido</small
          >
        </div>
        
        <div>
          <label
            for="clave"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Contraseña</label
          >
          <input
            type="password"
            id="clave"
            formControlName="clave"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="******"
            maxlength="30"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('clave')?.hasError('required') &&
              registroForm.get('clave')?.touched
            "
            >*requerido</small
          >
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('clave')?.hasError('minlength') &&
              registroForm.get('clave')?.touched
            "
            >*contraseña demasiado corta</small
          >
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            for="confirmarClave"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Confirmar Contraseña</label
          >
          <input
            type="password"
            id="confirmarClave"
            formControlName="confirmarClave"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="******"
            maxlength="30"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.hasError('passwordsNoMatch') &&
              registroForm.get('confirmarClave')?.touched
            "
            >*Las contraseñas no coinciden</small
          >
        </div>
        <div>
          <label
            for="idProvincia"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Provincia</label
          >
          <select
            id="idProvincia"
            formControlName="idProvincia"
            (change)="cargarCiudades($event)"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
          >
            <option disabled value="">Selecciona una provincia</option>
            @for (provincia of provinciaCiudadService.provincias(); track
            $index) {
            <option [value]="provincia.id">{{ provincia.nombre }}</option>
            }
          </select>
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('idProvincia')?.invalid &&
              registroForm.get('idProvincia')?.touched
            "
            >*requerido</small
          >
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            for="idCiudad"
            class="mb-2 block text-sm font-medium text-gray-900 dark:text-white"
            >Ciudad</label
          >
          <select
            id="idCiudad"
            formControlName="idCiudad"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
          >
            <option disabled value="">Selecciona una ciudad</option>
            @for (ciudad of ciudades; track ciudad.id) {
            <option [value]="ciudad.id">{{ ciudad.nombre }}</option>
            }
          </select>
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('idCiudad')?.invalid &&
              registroForm.get('idCiudad')?.touched
            "
            >*requerido</small
          >
        </div>
        <div>
          <label
            for="direccion"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Dirección</label
          >
          <input
            type="text"
            id="direccion"
            formControlName="direccion"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="Dirección"
            maxlength="100"
          />
          <small
            class="text-red-500"
            *ngIf="
              registroForm.get('direccion')?.invalid &&
              registroForm.get('direccion')?.touched
            "
            >*requerido</small
          >
        </div>
      </div>
    </form>
    <div class="mt-8 items-center flex justify-end">
      <button
        class="w-full flex items-center justify-center gap-2 rounded-md whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 text-white bg-lime-600 dark:bg-blue-600 hover:bg-lime-500 dark:hover:bg-blue-400 px-7 py-3"
        type="submit"
        (click)="registrar()"
        [disabled]="loading"
      >
        <svg
          *ngIf="loading"
          class="w-5 h-5 animate-spin text-white"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8v4l3-3-3-3V4a8 8 0 018 8H4z"
          ></path>
        </svg>
        Registrarme
      </button>
    </div>
  </div>
  <app-dialogo-validacion-correo
    *ngIf="mostrarDialogo"
    (cerrarDialogo)="
      mostrarDialogo = false; router.navigateByUrl('/auth/login')
    "
  ></app-dialogo-validacion-correo>
</div>
